{
  "_meta": {
    "launcher_path": "/interlude",
    "project_name": "Interlude"
  },
  "helm-nemo": {
    "description": "NeMo Microservices Helm Chart (with auto-fetch)",
    "versions": ["25.12.0", "25.10.0"],
    "default_version": "25.12.0",
    "working_dir": ".",
    "env_var": "NGC_API_KEY",
    "heading": "Deploy NeMo Microservices",
    "namespace": "nemo",
    "pre_commands": [
      "echo 'ðŸ” Checking Kubernetes cluster connectivity...' && kubectl cluster-info --request-timeout=10s",
      "echo 'ðŸŒ Checking ingress controller...' && (kubectl get daemonset -n ingress nginx-ingress-microk8s-controller 2>/dev/null && echo '   âœ“ microk8s ingress enabled') || (command -v microk8s &>/dev/null && echo '   Enabling microk8s ingress...' && microk8s enable ingress) || echo '   (non-microk8s cluster, ensure ingress-nginx is installed)'",
      "echo 'ðŸŒ‹ Installing Volcano scheduler...' && kubectl apply -f https://raw.githubusercontent.com/volcano-sh/volcano/master/installer/volcano-development.yaml 2>/dev/null || echo '   (Volcano may already be installed)'",
      "rm -rf nemo-microservices-helm-chart nemo-microservices-helm-chart-*.tgz",
      "helm fetch https://helm.ngc.nvidia.com/nvidia/nemo-microservices/charts/nemo-microservices-helm-chart-${VERSION}.tgz --username='$oauthtoken' --password=\"${NGC_API_KEY}\"",
      "tar -xzf nemo-microservices-helm-chart-${VERSION}.tgz"
    ],
    "command": "helm install nemo-microservices ./nemo-microservices-helm-chart --set ngcAPIKey=\"${NGC_API_KEY}\" --set existingSecret=\"\" --set existingImagePullSecret=\"\" --set studio.platformBaseUrl=\"${PLATFORM_URL}\" --set studio.entityStoreUrl=\"${PLATFORM_URL}\" --set studio.nimProxyUrl=\"${PLATFORM_URL}\" --set studio.dataStoreUrl=\"${PLATFORM_URL}\" --set ingress.hosts.default.name=\"${INGRESS_HOST}\" --set ingress.hosts.nimProxy.name=\"${INGRESS_HOST}\" --set ingress.hosts.dataStore.name=\"${INGRESS_HOST}\" --set tags.auditor=true --set tags.studio=true --set tags.safe-synthesizer=true --create-namespace --namespace nemo",
    "post_commands": [
      "echo 'ðŸ““ Deploying Jupyter with NVIDIA GenerativeAIExamples...' && kubectl apply -f https://raw.githubusercontent.com/liveaverage/launch-brev-nmp/main/k8s/jupyter-deployment.yaml && echo '   âœ“ Jupyter deployed to namespace: jupyter'",
      "echo 'â³ Waiting for Jupyter pod...' && kubectl wait --for=condition=ready pod -l app=jupyter -n jupyter --timeout=120s 2>/dev/null || echo '   (Jupyter still starting, will be available shortly)'",
      "bash nemo-proxy/configure-proxy.sh"
    ],
    "success_check": "kubectl get pods -n nemo --no-headers | grep -v Completed | grep -E 'Running|Pending' | head -1",
    "uninstall_commands": [
      "echo 'ðŸ—‘ï¸ Uninstalling NeMo Microservices...'",
      "helm uninstall nemo-microservices --namespace nemo || true",
      "kubectl delete namespace nemo --timeout=60s || true",
      "echo 'ðŸ““ Uninstalling Jupyter...' && kubectl delete -f https://raw.githubusercontent.com/liveaverage/launch-brev-nmp/main/k8s/jupyter-deployment.yaml 2>/dev/null || true",
      "echo 'âœ“ Uninstall complete'"
    ],
    "log_sources": [
      {"label": "Pod Status", "command": "kubectl get pods -n nemo -o wide"},
      {"label": "Services", "command": "kubectl get svc -n nemo"}
    ]
  },
  "helm-nemo-local": {
    "description": "NeMo Microservices Helm Chart (local chart)",
    "versions": [],
    "default_version": "",
    "working_dir": ".",
    "env_var": "NGC_API_KEY",
    "namespace": "nemo",
    "pre_commands": [
      "echo 'ðŸ” Checking Kubernetes cluster connectivity...' && kubectl cluster-info --request-timeout=10s",
      "echo 'ðŸŒ Checking ingress controller...' && (kubectl get daemonset -n ingress nginx-ingress-microk8s-controller 2>/dev/null && echo '   âœ“ microk8s ingress enabled') || (command -v microk8s &>/dev/null && echo '   Enabling microk8s ingress...' && microk8s enable ingress) || echo '   (non-microk8s cluster, ensure ingress-nginx is installed)'",
      "echo 'ðŸŒ‹ Installing Volcano scheduler...' && kubectl apply -f https://raw.githubusercontent.com/volcano-sh/volcano/master/installer/volcano-development.yaml 2>/dev/null || echo '   (Volcano may already be installed)'"
    ],
    "command": "helm install nemo-microservices ./nemo-microservices-helm-chart --set ngcAPIKey=\"${NGC_API_KEY}\" --set existingSecret=\"\" --set existingImagePullSecret=\"\" --set studio.platformBaseUrl=\"${PLATFORM_URL}\" --set studio.entityStoreUrl=\"${PLATFORM_URL}\" --set studio.nimProxyUrl=\"${PLATFORM_URL}\" --set studio.dataStoreUrl=\"${PLATFORM_URL}\" --set ingress.hosts.default.name=\"${INGRESS_HOST}\" --set ingress.hosts.nimProxy.name=\"${INGRESS_HOST}\" --set ingress.hosts.dataStore.name=\"${INGRESS_HOST}\" --set tags.auditor=true --set tags.studio=true --set tags.safe-synthesizer=true --create-namespace --namespace nemo",
    "post_commands": [
      "echo 'ðŸ““ Deploying Jupyter with NVIDIA GenerativeAIExamples...' && kubectl apply -f https://raw.githubusercontent.com/liveaverage/launch-brev-nmp/main/k8s/jupyter-deployment.yaml && echo '   âœ“ Jupyter deployed to namespace: jupyter'",
      "echo 'â³ Waiting for Jupyter pod...' && kubectl wait --for=condition=ready pod -l app=jupyter -n jupyter --timeout=120s 2>/dev/null || echo '   (Jupyter still starting, will be available shortly)'",
      "bash nemo-proxy/configure-proxy.sh"
    ],
    "success_check": "kubectl get pods -n nemo --no-headers | grep -v Completed | grep -E 'Running|Pending' | head -1",
    "uninstall_commands": [
      "echo 'ðŸ—‘ï¸ Uninstalling NeMo Microservices...'",
      "helm uninstall nemo-microservices --namespace nemo || true",
      "kubectl delete namespace nemo --timeout=90s || true",
      "echo 'ðŸ““ Uninstalling Jupyter...' && kubectl delete -f https://raw.githubusercontent.com/liveaverage/launch-brev-nmp/main/k8s/jupyter-deployment.yaml 2>/dev/null || true",
      "echo 'âœ“ Uninstall complete'"
    ],
    "log_sources": [
      {"label": "Pod Status", "command": "kubectl get pods -n nemo -o wide"},
      {"label": "Services", "command": "kubectl get svc -n nemo"}
    ]
  },
  "docker-compose-nemo": {
    "description": "NeMo Microservices Docker Compose",
    "versions": [],
    "default_version": "",
    "working_dir": "/app",
    "env_var": "NGC_API_KEY",
    "pre_commands": [],
    "command": "cd nemo-microservices-quickstart_25.12 && docker-compose up -d"
  }
}
